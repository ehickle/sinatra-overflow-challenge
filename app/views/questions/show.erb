<div class="question-page">
  <h2 class="inline"><%= @question.title %></h2>

  <div class='vote-data inline'>

    <% if logged_in? %>
      <form class="inline vote-buttons" action="/questions/<%= @question.id %>/votes" method="post">
        <input type="hidden" name="vote" value="1">
        <button name="upvote" class='thumbs'><i class="fa fa-thumbs-o-up"></i></button>
      </form>
    <% end %>

    <% if @question.vote_value > 0 %>
      <h3 class="inline vote-count positive-vote">
        <%= @question.vote_value %>
      </h3>
    <% elsif @question.vote_value < 0 %>
      <h3 class="inline vote-count negative-vote">
        <%= @question.vote_value %>
      </h3>
    <% else %>
      <h3 class="inline vote-count">
        <%= @question.vote_value %>
      </h3>
    <% end %>

    <% if logged_in? %>
      <form class="inline vote-buttons" action="/questions/<%= @question.id %>/votes" method="post">
        <input type="hidden" name="vote" value="-1">
        <button name="downvote" class='thumbs'><i class="fa fa-thumbs-o-down"></i></button>
      </form>
    <% end %>

  </div>

  <h3><%= @question.body %></h3>

  <!-- START display comments for each question -->

  <% if @question.comments.any? %>
  <div class="comment-div">
    <% @question.comments.reverse.each do |comment| %>
      <p class="comment">

      <% if current_user == comment.commenter %>
        <a href="/comments/<%= comment.id %>/delete" class="delete">delete</a>
      <% end %>

        <%= comment.body %><br>
        <!-- TODO: fix datetime display -->

        <small class="posted-on">
          <%= comment.time_since_creation %> hours ago by <a href="/users/<%=comment.commenter.id %>"><%=comment.commenter.username%></a>
        </small>

      </p>
    <% end %>
  </div>
  <% end %>

  <% if logged_in? %>
    <a href="/questions/<%= @question.id %>/comments/new">Comment</a>
    <% if @new_comment_on_question %>
      <form method="POST" action="/questions/<%= @question.id %>/comments">
        <input type="text" name="body" placeholder="Comment here...">
        <input type="submit" value="Save">
      </form>
    <% end %>
  <% end %>

  <!-- END display comments for each question -->

  <% if @question.answers.any? %>
    <h4>Answers</h4>
  <% end %>

  <ul>
    <% @question.answers.each do |answer| %>
      <li>
        <div class='vote-data inline'>
          <% if logged_in? %>
            <form class="inline vote-buttons" action="/answers/<%=answer.id%>/votes" method="post">
              <input type="hidden" name="vote" value="1">
              <button name="upvote" class='thumbs'><i class="fa fa-thumbs-o-up"></i></button>
            </form>
          <% end %>

            <% if answer.vote_value > 0 %>
              <h3 class="inline vote-count positive-vote">
                 <%= answer.vote_value %>
              </h3>
            <% elsif answer.vote_value < 0 %>
              <h3 class="inline vote-count negative-vote">
                <%= answer.vote_value.to_s %>
              </h3>
            <% else %>
              <h3 class="inline vote-count">
                <%= answer.vote_value %>
              </h3>
            <% end %>

          <% if logged_in? %>
            <form class="inline vote-buttons" action="/answers/<%=answer.id%>/votes" method="post">
              <input type="hidden" name="vote" value="-1">
              <button name="downvote" class='thumbs'><i class="fa fa-thumbs-o-down"></i></button>
            </form>
          <% end %>
        </div>

        <div class = 'inline answer-bodies'>
          <p><%= answer.body %> </p>
          <small class='answer-data'><p> <%= answer.time_since_creation %> hours ago</p>
          <p> <a href="/users/<%= answer.author.id %>"><%= answer.author.username %></a> |</p></small>
        </div>

          <% if current_user == answer.author %>
            <form action ="/answers/<%= answer.id %>" method='post' id='delete-button' class='inline'>
              <input type='hidden' name='_method' value='delete'>
              <input type='submit' value ='delete'>
            </form>
          <% end %>

      </li>

      <!-- START display comments for each answer -->

      <% if answer.comments.any? %>
  <div class="comment-div">
    <% answer.comments.reverse.each do |comment| %>
      <p class="comment">

      <% if current_user == comment.commenter %>
        <a href="/comments/<%= comment.id %>/delete" class="delete">delete</a>
      <% end %>

        <%= comment.body %><br>
        <!-- TODO: fix datetime display -->

        <small class="posted-on">
          <%= comment.time_since_creation %> hours ago by <a href="/users/<%=comment.commenter.id %>"><%=comment.commenter.username%></a>
        </small>

      </p>
    <% end %>
  </div>
  <% end %>

  <% if logged_in? %>
    <a href="/questions/<%= @question.id %>/answers/<%= answer.id %>/comments/new">Comment</a>
    <% if @new_comment_on_answer == answer.id %>
      <form method="POST" action="/questions/<%= @question.id %>/answers/<%= @answer.id %>/comments">
        <input type="text" name="body" placeholder="Comment here...">
        <input type="submit" value="Save">
      </form>
    <% end %>
  <% end %>
  
      <!-- END display comments for each answer -->

    <% end %>
  </ul>

  <% if logged_in? && current_user == @question.author %>
    <form>
      <input type="submit" value="Delete Question">
    </form>
  <% elsif logged_in? && current_user != @question.author %>
  <hr>
    <p>Submit answer:</p>
    <form action="/questions/<%= @question.id %>/answers" method="POST" class="new_answer_form">
      <textarea name="body" rows=10></textarea><br>
      <input type="submit" value="Submit Answer">
    </form>
  <% end %>
</div>
